# Configuration pour déploiement serveur sans IP fixe
# Copier ce fichier vers .env et adapter les valeurs selon votre serveur

# ==================== CONFIGURATION GÉNÉRALE ====================
DEBUG=false
LOG_LEVEL=INFO
ENVIRONMENT=production

# ==================== BASE DE DONNÉES ====================
POSTGRES_DB=data_warehouse
POSTGRES_USER=warehouse_user
POSTGRES_PASSWORD=warehouse_password_CHANGE_IN_PRODUCTION
DATABASE_URL=postgresql://warehouse_user:warehouse_password_CHANGE_IN_PRODUCTION@warehouse-service:5432/data_warehouse

# ==================== API DASHBOARD ====================
SECRET_KEY=your-very-secure-secret-key-here-CHANGE-IN-PRODUCTION
API_TITLE=SaaS Data Platform API - Serveur
API_VERSION=1.0.0
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# ==================== REDIS ====================
REDIS_URL=redis://redis-cache:6379
REDIS_PASSWORD=
REDIS_DB=0

# ==================== SERVICES ====================
NIFI_SERVICE_URL=http://nifi-service:8080
DBT_SERVICE_URL=http://dbt-service:8001
RECONCILIATION_SERVICE_URL=http://reconciliation-service:8002
QUALITY_CONTROL_SERVICE_URL=http://quality-control-service:8003
RCA_SERVICE_URL=http://rca-service:8004

# ==================== MONITORING ====================
PROMETHEUS_URL=http://prometheus:9090
GRAFANA_URL=http://grafana:3000
GRAFANA_ADMIN_PASSWORD=secure_admin_password_CHANGE_IN_PRODUCTION
PROMETHEUS_RETENTION=30d

# ==================== NGINX ====================
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
NGINX_CLIENT_MAX_BODY_SIZE=100M

# ==================== SÉCURITÉ ====================
# Pour un serveur sans IP fixe, vous pouvez utiliser * ou spécifier votre domaine
CORS_ORIGINS=*
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_HEADERS=*
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# ==================== FICHIERS ====================
UPLOAD_MAX_SIZE=100MB
UPLOAD_DIRECTORY=uploads
EXPORT_DIRECTORY=exports
TEMP_DIRECTORY=temp

# ==================== ALERTES ====================
EMAIL_ENABLED=false
EMAIL_SMTP_SERVER=localhost
EMAIL_SMTP_PORT=587
EMAIL_USERNAME=
EMAIL_PASSWORD=
EMAIL_FROM=noreply@your-server-domain.com

# ==================== ZINGG ====================
ZINGG_WORKSPACE=/tmp/zingg_workspace
ZINGG_MODEL_PATH=/tmp/zingg_models
DEFAULT_SIMILARITY_THRESHOLD=0.8

# ==================== SODA ====================
SODA_CONFIG_PATH=/app/soda_config
SODA_CHECKS_PATH=/app/soda_checks
COMPLETENESS_THRESHOLD=90.0
CONSISTENCY_THRESHOLD=95.0

# ==================== RCA ====================
MAX_ANALYSIS_DEPTH=5
CORRELATION_THRESHOLD=0.7
ANOMALY_CONTAMINATION=0.1

# ==================== DBT ====================
DBT_PROJECT_DIR=/app
DBT_PROFILES_DIR=/app/profiles
DBT_TARGET=prod

# ==================== KAFKA (OPTIONNEL) ====================
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_TOPIC_CDR=cdr-events
KAFKA_TOPIC_ALERTS=alerts

# ==================== MINIO (OPTIONNEL) ====================
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123_CHANGE_IN_PRODUCTION
MINIO_BUCKET_NAME=saas-data

# ==================== CONFIGURATION AVANCÉE ====================
# Pool de connexions base de données
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30

# Cache
CACHE_ENABLED=true
CACHE_TTL=3600
CACHE_MAX_SIZE=2000

# Performance - Configuration optimisée pour serveur
MAX_CONCURRENT_TASKS=20
TASK_TIMEOUT=600
BATCH_SIZE=2000

# Logs
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=logs/saas-platform.log
MAX_LOG_SIZE=50MB
BACKUP_COUNT=10

# ==================== CONFIGURATION SERVEUR ====================
# Configuration spécifique pour serveur sans IP fixe

# Ports exposés (utilisés par docker-compose.server.yml)
API_DASHBOARD_PORT=9000
NIFI_PORT=9080
DBT_SERVICE_PORT=9001
RECONCILIATION_SERVICE_PORT=9002
QUALITY_CONTROL_SERVICE_PORT=9003
RCA_SERVICE_PORT=9004
POSTGRES_PORT=9543
REDIS_PORT=9637
GRAFANA_PORT=9300
PROMETHEUS_PORT=9090

# Configuration réseau
SERVER_HOST=0.0.0.0
SERVER_PORT=80
NGINX_HOST=0.0.0.0

# Configuration pour accès externe
EXTERNAL_ACCESS=true
ALLOWED_HOSTS=*
TRUSTED_PROXIES=*

# ==================== BACKUP ET MAINTENANCE ====================
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_DIRECTORY=/backups

# Maintenance
MAINTENANCE_MODE=false
AUTO_UPDATE=false

# ==================== SÉCURITÉ SERVEUR ====================
# Configuration de sécurité renforcée pour serveur

# Limitation des ressources
MAX_MEMORY_PER_CONTAINER=1G
MAX_CPU_PER_CONTAINER=1.0

# Firewall (si configuré)
FIREWALL_ENABLED=false
ALLOWED_PORTS=80,443,9000,9001,9002,9003,9004,9080,9090,9300,9543,9637

# SSL/TLS (optionnel - nécessite des certificats)
SSL_ENABLED=false
SSL_CERT_PATH=/etc/ssl/certs/cert.pem
SSL_KEY_PATH=/etc/ssl/private/key.pem

# ==================== MONITORING SERVEUR ====================
# Configuration monitoring spécifique serveur

# Alertes système
SYSTEM_ALERTS_ENABLED=true
DISK_USAGE_THRESHOLD=80
MEMORY_USAGE_THRESHOLD=85
CPU_USAGE_THRESHOLD=90

# Logs système
SYSTEM_LOGS_ENABLED=true
SYSTEM_LOG_RETENTION=30d

# Métriques système
SYSTEM_METRICS_ENABLED=true
SYSTEM_METRICS_INTERVAL=60s

# ==================== VARIABLES D'ENVIRONNEMENT SPÉCIFIQUES ====================
# Docker
COMPOSE_PROJECT_NAME=saas-platform-server
COMPOSE_FILE=docker-compose.server.yml

# Python
PYTHONPATH=/app
PYTHONDONTWRITEBYTECODE=1
PYTHONUNBUFFERED=1

# Timezone
TZ=Europe/Paris

# ==================== CONFIGURATION POUR DOMAINE DYNAMIQUE ====================
# Si vous utilisez un service de domaine dynamique (No-IP, DuckDNS, etc.)

# DYNAMIC_DOMAIN_ENABLED=false
# DYNAMIC_DOMAIN_SERVICE=duckdns
# DYNAMIC_DOMAIN_NAME=your-domain.duckdns.org
# DYNAMIC_DOMAIN_TOKEN=your-token

# ==================== CONFIGURATION POUR ACCÈS EXTERNE ====================
# Configuration pour accès depuis l'extérieur

# URL de base pour les notifications et liens
BASE_URL=http://your-server-ip-or-domain
API_BASE_URL=http://your-server-ip-or-domain/api
DASHBOARD_BASE_URL=http://your-server-ip-or-domain/dashboard

# Configuration pour reverse proxy externe (si utilisé)
EXTERNAL_PROXY=false
EXTERNAL_PROXY_IP=
EXTERNAL_PROXY_PORT=

# ==================== CONFIGURATION DE DÉVELOPPEMENT ====================
# Décommenter uniquement pour le développement/debug

# DEBUG=true
# LOG_LEVEL=DEBUG
# HOT_RELOAD=false
# MOCK_EXTERNAL_SERVICES=false
